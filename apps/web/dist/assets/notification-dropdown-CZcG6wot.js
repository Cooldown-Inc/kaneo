import{e as z,c as M,n as H,r as T,b as G,j as t,d as L}from"./index-D6_JMR29.js";import{b as P,c as J,d as U,f as V,a as W,e as X,g as Z,A as ee}from"./alert-dialog-Df-VbuAQ.js";import{B as te}from"./badge-DgtRj8pM.js";import{B as Q}from"./button-EC3LtV52.js";import{i as se,d as ie,e as ae,c as ne}from"./layout-CW2eFLdS.js";import{s as q,T as oe,c as le,K as re,a as ce,b as de}from"./tooltip-CdvJmOJg.js";import{u as Y}from"./useMutation-B_C6xvhR.js";import{u as me}from"./useQuery-BDxn_D7I.js";import{c as fe}from"./createLucideIcon-CRcKb1Ol.js";/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ue=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]],I=fe("bell",ue);async function he(){const s=await z.notification["clear-all"].$delete();if(!s.ok){const e=await s.text();throw new Error(e)}return await s.json()}function xe(){const s=M.c(2),i=H();let e;return s[0]!==i?(e={mutationFn:he,onSuccess:()=>{i.invalidateQueries({queryKey:["notifications"]})}},s[0]=i,s[1]=e):e=s[1],Y(e)}async function pe(){const s=await z.notification["read-all"].$patch();if(!s.ok){const e=await s.text();throw new Error(e)}return await s.json()}function ge(){const s=M.c(2),i=H();let e;return s[0]!==i?(e={mutationFn:pe,onSuccess:()=>{i.invalidateQueries({queryKey:["notifications"]})}},s[0]=i,s[1]=e):e=s[1],Y(e)}async function je(){const s=await z.notification.$get();if(!s.ok){const e=await s.text();throw new Error(e)}return await s.json()}function Ne(){const s=M.c(1);let i;return s[0]===Symbol.for("react.memo_cache_sentinel")?(i={queryKey:["notifications"],queryFn:je},s[0]=i):i=s[0],me(i)}const we=T.forwardRef((s,i)=>{const e=M.c(48),{data:n}=Ne(),[a,$]=T.useState(!1),[E,B]=T.useState(!1),{mutate:F}=ge(),{mutate:K}=xe();let w;e[0]!==n?(w=n?.filter(ve)||[],e[0]=n,e[1]=w):w=e[1];const o=w,l=n&&n.length>0;let v;e[2]!==a?(v=()=>({toggle:()=>$(!a)}),e[2]=a,e[3]=v):v=e[3],T.useImperativeHandle(i,v);let y;e[4]!==K?(y=()=>{K(),B(!1)},e[4]=K,e[5]=y):y=e[5];const O=y;let b;e[6]!==a?(b={sequentialShortcuts:{[q.notification.prefix]:{[q.notification.open]:()=>$(!a)}}},e[6]=a,e[7]=b):b=e[7],G(b);let C;e[8]===Symbol.for("react.memo_cache_sentinel")?(C=t.jsx(I,{className:"h-4 w-4"}),e[8]=C):C=e[8];let r;e[9]!==o.length?(r=o.length>0&&t.jsx("span",{className:"absolute top-0 right-0 h-2 w-2 bg-red-500 rounded-full"}),e[9]=o.length,e[10]=r):r=e[10];let A;e[11]===Symbol.for("react.memo_cache_sentinel")?(A=t.jsx("span",{className:"sr-only",children:"Notifications"}),e[11]=A):A=e[11];let c;e[12]!==r?(c=t.jsx(oe,{asChild:!0,children:t.jsx(ie,{asChild:!0,children:t.jsxs(Q,{variant:"ghost",size:"sm",className:"relative h-9 w-9 p-0",children:[C,r,A]})})}),e[12]=r,e[13]=c):c=e[13];let _;e[14]===Symbol.for("react.memo_cache_sentinel")?(_=t.jsx(le,{children:t.jsx("p",{className:"flex items-center gap-2",children:t.jsx(re,{keys:[q.notification.prefix,q.notification.open],description:"Open notifications"})})}),e[14]=_):_=e[14];let d;e[15]!==c?(d=t.jsx(ce,{children:t.jsxs(de,{children:[c,_]})}),e[15]=c,e[16]=d):d=e[16];let D;e[17]===Symbol.for("react.memo_cache_sentinel")?(D=t.jsx("h3",{className:"font-medium text-sm",children:"Notifications"}),e[17]=D):D=e[17];let m;e[18]!==F||e[19]!==o.length?(m=o.length>0&&t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs(te,{variant:"secondary",className:"text-xs",children:[o.length," new"]}),t.jsx(Q,{variant:"ghost",size:"sm",onClick:()=>F(),className:"text-xs h-6 px-2",children:"Mark all read"})]}),e[18]=F,e[19]=o.length,e[20]=m):m=e[20];let f;e[21]!==m?(f=t.jsxs("div",{className:"flex items-center justify-between px-3 py-2 border-b",children:[D,m]}),e[21]=m,e[22]=f):f=e[22];let u;e[23]!==l||e[24]!==n?(u=l?n.map(ye):t.jsxs("div",{className:"p-6 text-center text-sm text-muted-foreground",children:[t.jsx(I,{className:"mx-auto h-12 w-12 opacity-50 mb-2"}),t.jsx("p",{children:"No notifications yet"}),t.jsx("p",{className:"text-xs mt-1",children:"You'll see updates and activity here."})]}),e[23]=l,e[24]=n,e[25]=u):u=e[25];let h;e[26]!==u?(h=t.jsx("div",{className:"relative max-h-96 overflow-y-auto",children:u}),e[26]=u,e[27]=h):h=e[27];let x;e[28]!==l?(x=l&&t.jsx("div",{className:"border-t border-border p-2",children:t.jsx(Q,{variant:"ghost",size:"sm",onClick:()=>B(!0),className:"w-full text-xs text-destructive hover:text-destructive hover:bg-destructive/10",children:"Clear all notifications"})}),e[28]=l,e[29]=x):x=e[29];let p;e[30]!==f||e[31]!==h||e[32]!==x?(p=t.jsxs(ae,{align:"end",className:"w-80 p-0",children:[f,h,x]}),e[30]=f,e[31]=h,e[32]=x,e[33]=p):p=e[33];let g;e[34]!==a||e[35]!==p||e[36]!==d?(g=t.jsxs(ne,{open:a,onOpenChange:$,children:[d,p]}),e[34]=a,e[35]=p,e[36]=d,e[37]=g):g=e[37];let S;e[38]===Symbol.for("react.memo_cache_sentinel")?(S=t.jsxs(P,{children:[t.jsx(J,{children:"Clear all notifications?"}),t.jsx(U,{children:"This will permanently remove all notifications. You can't undo this action."})]}),e[38]=S):S=e[38];let k;e[39]===Symbol.for("react.memo_cache_sentinel")?(k=t.jsx(V,{children:"Cancel"}),e[39]=k):k=e[39];let j;e[40]!==O?(j=t.jsxs(W,{children:[S,t.jsxs(X,{children:[k,t.jsx(Z,{onClick:O,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Clear all"})]})]}),e[40]=O,e[41]=j):j=e[41];let N;e[42]!==E||e[43]!==j?(N=t.jsx(ee,{open:E,onOpenChange:B,children:j}),e[42]=E,e[43]=j,e[44]=N):N=e[44];let R;return e[45]!==g||e[46]!==N?(R=t.jsxs(t.Fragment,{children:[g,N]}),e[45]=g,e[46]=N,e[47]=R):R=e[47],R});we.displayName="NotificationDropdown";function ve(s){return!s.isRead}function ye(s){return t.jsx("div",{className:L("px-3 py-3 border-b border-border/50 hover:bg-accent/50 transition-colors",!s.isRead&&"bg-accent/20"),children:t.jsx("div",{className:"flex items-start gap-3",children:t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[t.jsx("h4",{className:"text-sm font-medium text-foreground",children:s.title}),!s.isRead&&t.jsx("div",{className:"w-2 h-2 bg-primary rounded-full flex-shrink-0"})]}),s.content&&t.jsx("p",{className:"text-xs text-muted-foreground line-clamp-2",children:s.content}),t.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:se(s.createdAt,{addSuffix:!0})})]})})},s.id)}export{we as N};
