import{c as n,f as t,r as a}from"./index-D6_JMR29.js";import{u as i}from"./use-active-workspace-DO0oIQWU.js";import{u as c}from"./useQuery-BDxn_D7I.js";const m=()=>{const r=n.c(1);let e;return r[0]===Symbol.for("react.memo_cache_sentinel")?(e={queryKey:["workspace-user","active"],queryFn:l},r[0]=e):e=r[0],c(e)};async function l(){const{data:r,error:e}=await t.organization.getActiveMember();if(e)throw new Error(e.message||"Failed to get active workspace user");return r}function d(){const{data:r}=i(),{data:e}=m();return{...a.useMemo(()=>({async hasPermission(o){try{return(await t.organization.hasPermission({permissions:o})).data||!1}catch(s){return console.error("Permission check failed:",s),!1}},checkRolePermission(o){if(!e?.role)return!1;try{return t.organization.checkRolePermission({permissions:o,role:e.role})}catch(s){return console.error("Role permission check failed:",s),!1}},canManageProjects(){return this.checkRolePermission({project:["create","update","delete"]})},canCreateProjects(){return this.checkRolePermission({project:["create"]})},canManageTasks(){return this.checkRolePermission({task:["create","update","delete"]})},canAssignTasks(){return this.checkRolePermission({task:["assign"]})},canManageWorkspace(){return this.checkRolePermission({workspace:["update","manage_settings"]})},canDeleteWorkspace(){return this.checkRolePermission({workspace:["delete"]})},canInviteUsers(){return this.checkRolePermission({team:["invite"]})},canManageTeam(){return this.checkRolePermission({team:["remove","manage_roles"]})},canRemoveMembers(){return this.checkRolePermission({team:["remove"]})},checkPermission(o="member"){if(!r||!e)return!1;const s=e.role;return o==="owner"?s==="owner":o==="admin"?["owner","admin"].includes(s):["owner","admin","member"].includes(s)},isOwner:e?.role==="owner",isAdmin:["owner","admin"].includes(e?.role||""),role:e?.role}),[e,r]),workspace:r,member:e}}export{d as u};
