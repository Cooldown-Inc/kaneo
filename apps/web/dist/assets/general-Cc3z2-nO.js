import{c as N,f as D,n as W,a as A,r as l,t as x,j as e}from"./index-D6_JMR29.js";import{s as S,o as E,a as j}from"./schemas-BanlPZIc.js";import{u as I}from"./index.esm-C6Qxl6lY.js";import{P as T}from"./page-title-D2qfPOLM.js";import{A as z,a as _,b as q,c as M,d as R,e as Q,f as K,g as O}from"./alert-dialog-Df-VbuAQ.js";import{B as P}from"./button-EC3LtV52.js";import{F as $,a as g,b as y,c as k,d as v,e as w}from"./form-Bsr6zOGs.js";import{I as b}from"./input-BncAdNhM.js";import{S as B}from"./separator-Cv6BfWof.js";import{u as F}from"./useMutation-B_C6xvhR.js";import{c as G}from"./create-slug-VE8e1keW.js";import{u as V}from"./use-active-workspace-DO0oIQWU.js";import"./index-BlCpMXjl.js";import"./index-D2z6sO9D.js";import"./index-Dtyx9z7_.js";import"./index-J3ygd6UU.js";import"./index-sjf38YVm.js";import"./index-DlhLTHW_.js";import"./index-Bkpo5cC8.js";import"./index-BnceiTS-.js";import"./index-BrfIpMvE.js";import"./label-EHONJWOK.js";import"./index-MjJcs9DE.js";import"./index-Xyhz7DHc.js";function H(){const s=N.c(1);let t;return s[0]===Symbol.for("react.memo_cache_sentinel")?(t={mutationFn:L},s[0]=t):t=s[0],F(t)}async function L(s){const{workspaceId:t}=s,{data:o,error:c}=await D.organization.delete({organizationId:t});if(c)throw new Error(c.message||"Failed to delete workspace");return o}function U(){const s=N.c(1);let t;return s[0]===Symbol.for("react.memo_cache_sentinel")?(t={mutationFn:J},s[0]=t):t=s[0],F(t)}async function J(s){const{workspaceId:t,name:o,slug:c,logo:d,metadata:a}=s,i={};o!==void 0&&(i.name=o,c===void 0&&(i.slug=G(o))),c!==void 0&&(i.slug=c),d!==void 0&&(i.logo=d),a!==void 0&&(i.metadata=a);const{data:p,error:m}=await D.organization.update({data:i,organizationId:t});if(m)throw new Error(m.message||"Failed to update workspace");return p}const X=E({name:j().min(1,"Workspace name is required").min(2,"Workspace name must be at least 2 characters"),description:j().optional()});function we(){const s=W(),t=A(),o=l.useRef(null),[c,d]=l.useState(!1),{data:a}=V(),{mutateAsync:i}=U(),{mutateAsync:p,isPending:m}=H(),n=I({resolver:S(X),defaultValues:{name:a?.name||"",description:a?.metadata?.description||""}});l.useEffect(()=>{a&&n.reset({name:a.name||"",description:a.metadata?.description||""})},[a,n]);const f=l.useCallback(async r=>{if(a?.id)try{await i({workspaceId:a.id,name:r.name.trim(),metadata:{description:r.description?.trim()||void 0}}),await s.invalidateQueries({queryKey:["active-organization"]}),x.success("Workspace updated successfully")}catch(u){x.error(u instanceof Error?u.message:"Failed to update workspace")}},[a?.id,i,s]),C=l.useCallback(async()=>{if(a?.id)try{await p({workspaceId:a.id}),x.success("Workspace deleted successfully"),await s.invalidateQueries({queryKey:["workspaces"]}),await s.invalidateQueries({queryKey:["active-organization"]}),t({to:"/dashboard"})}catch(r){x.error(r instanceof Error?r.message:"Failed to delete workspace")}},[a?.id,p,s,t]),h=l.useCallback(r=>{o.current&&clearTimeout(o.current),o.current=setTimeout(()=>{f(r)},1e3)},[f]);return l.useEffect(()=>{const r=n.watch(u=>{n.formState.isDirty&&n.formState.isValid&&h(u)});return()=>r.unsubscribe()},[n,h]),l.useEffect(()=>()=>{o.current&&clearTimeout(o.current)},[]),e.jsxs(e.Fragment,{children:[e.jsx(T,{title:"General Settings"}),e.jsxs("div",{className:"max-w-4xl mx-auto space-y-8",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("h1",{className:"text-2xl font-semibold",children:"General Settings"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage your workspace name and description."})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("h2",{className:"text-md font-medium",children:"Workspace Information"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Configure your workspace details and preferences."})]}),e.jsx("div",{className:"space-y-4 border border-border rounded-md p-4 bg-sidebar",children:e.jsx($,{...n,children:e.jsxs("form",{className:"space-y-4",children:[e.jsx(g,{control:n.control,name:"name",render:({field:r})=>e.jsxs(y,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(k,{className:"text-sm font-medium",children:"Workspace name"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"The name of your workspace"})]}),e.jsx(v,{children:e.jsx(b,{className:"w-64",placeholder:"Enter workspace name",...r})})]}),e.jsx(w,{})]})}),e.jsx(B,{}),e.jsx(g,{control:n.control,name:"description",render:({field:r})=>e.jsxs(y,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(k,{className:"text-sm font-medium",children:"Description"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"A brief description of your workspace"})]}),e.jsx(v,{children:e.jsx(b,{className:"w-64",placeholder:"Enter workspace description",...r})})]}),e.jsx(w,{})]})})]})})})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("h2",{className:"text-md font-medium",children:"Danger zone"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Irreversible and destructive actions."})]}),e.jsx("div",{className:"space-y-4 border border-border rounded-md p-4 bg-sidebar",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx("p",{className:"text-sm font-medium",children:"Delete workspace"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Schedule workspace to be permanently deleted"})]}),e.jsx(P,{variant:"ghost",size:"sm",className:"text-destructive hover:text-destructive transition-colors",type:"button",onClick:()=>d(!0),children:"Delete workspace"})]})})]}),e.jsx(z,{open:c,onOpenChange:d,children:e.jsxs(_,{children:[e.jsxs(q,{children:[e.jsx(M,{children:"Delete Workspace?"}),e.jsxs(R,{children:['This will permanently delete the workspace "',a?.name,'" and all its data. This action cannot be undone.']})]}),e.jsxs(Q,{children:[e.jsx(K,{children:"Cancel"}),e.jsx(O,{onClick:C,disabled:m,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:m?"Deleting...":"Delete Workspace"})]})]})})]})]})}export{we as component};
