import{n as E,a as S,r as i,m as V,t as l,j as e,d as q}from"./index-D6_JMR29.js";import{s as K,o as O,a as d}from"./schemas-BanlPZIc.js";import{u as L}from"./index.esm-C6Qxl6lY.js";import{P as Q}from"./page-title-D2qfPOLM.js";import{A as R,a as M,b as B,c as G,d as U,e as H,f as W,g as _}from"./alert-dialog-Df-VbuAQ.js";import{B as $}from"./button-EC3LtV52.js";import{F as J,a as u,b as p,c as x,d as j,e as h}from"./form-Bsr6zOGs.js";import{I as f}from"./input-BncAdNhM.js";import{P as X,a as Y,b as Z}from"./popover-1qwL5cRb.js";import{S as g}from"./separator-Cv6BfWof.js";import{i as y}from"./project-icons-C5t--tF0.js";import{u as ee}from"./use-delete-project-WU8lx2qP.js";import{u as se}from"./use-update-project-DcmMD1Rw.js";import{u as te}from"./use-get-project-BeZMn5W-.js";import{u as re}from"./use-active-workspace-DO0oIQWU.js";import"./index-BlCpMXjl.js";import"./index-D2z6sO9D.js";import"./index-Dtyx9z7_.js";import"./index-J3ygd6UU.js";import"./index-sjf38YVm.js";import"./index-DlhLTHW_.js";import"./index-Bkpo5cC8.js";import"./index-BnceiTS-.js";import"./index-BrfIpMvE.js";import"./label-EHONJWOK.js";import"./index-MjJcs9DE.js";import"./index-Xyhz7DHc.js";import"./index-IN0mQVXW.js";import"./index-DomteP0B.js";import"./createLucideIcon-CRcKb1Ol.js";import"./users-DuQM-a9l.js";import"./user-G-k1XeFN.js";import"./settings-8jW1THm0.js";import"./search-BHoHnvlf.js";import"./list-gjk-xblB.js";import"./building-2-DuX-XVkM.js";import"./useMutation-B_C6xvhR.js";import"./useQuery-BDxn_D7I.js";const ie=O({name:d().min(1,"Project name is required").min(2,"Project name must be at least 2 characters"),slug:d().min(1,"Key is required").min(2,"Key must be at least 2 characters").max(8,"Key must be at most 8 characters"),description:d().optional(),icon:d().min(1,"Icon is required")});function Be(){const o=E(),b=S(),n=i.useRef(null),[C,v]=i.useState(!1),[I,N]=i.useState(!1),{data:c}=re(),{projectId:A}=V({strict:!1}),F=A??"",{data:t}=te({id:F??"",workspaceId:c?.id||""}),{mutateAsync:P}=se(),{mutateAsync:w,isPending:k}=ee(),r=L({resolver:K(ie),mode:"onChange",defaultValues:{name:t?.name||"",slug:t?.slug||"",description:t?.description||"",icon:t?.icon||"Layout"}});i.useEffect(()=>{t&&r.reset({name:t.name||"",slug:t.slug||"",description:t.description||"",icon:t.icon||"Layout"},{keepDirty:!1,keepTouched:!1,keepIsValid:!0})},[t,r]);const m=i.useCallback(async s=>{if(t?.id)try{await P({id:t.id,name:s.name.trim(),slug:s.slug.trim(),description:(s.description??"").trim(),icon:s.icon||t?.icon||"Layout",isPublic:!!t.isPublic}),await Promise.all([o.invalidateQueries({queryKey:["projects"]}),o.invalidateQueries({queryKey:["projects",c?.id]}),o.invalidateQueries({queryKey:["projects",c?.id,t.id]})]),l.success("Project updated successfully")}catch(a){l.error(a instanceof Error?a.message:"Failed to update project")}},[t?.id,t?.isPublic,t?.icon,P,o,c?.id]),D=i.useCallback(()=>{n.current&&clearTimeout(n.current),n.current=setTimeout(async()=>{if(await r.trigger()){const a=r.getValues();m(a)}},800)},[r,m]);i.useEffect(()=>{const s=r.watch(()=>{D()});return()=>s.unsubscribe()},[r,D]),i.useEffect(()=>()=>{n.current&&clearTimeout(n.current)},[]);const T=i.useCallback(async()=>{if(t?.id)try{await w({id:t.id}),l.success("Project deleted successfully"),await o.invalidateQueries({queryKey:["projects"]}),b({to:"/dashboard/workspace/$workspaceId",params:{workspaceId:c?.id||""}})}catch(s){l.error(s instanceof Error?s.message:"Failed to delete project")}},[t?.id,w,o,b,c?.id]);return e.jsxs(e.Fragment,{children:[e.jsx(Q,{title:"Project Settings"}),e.jsxs("div",{className:"max-w-4xl mx-auto space-y-8",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("h1",{className:"text-2xl font-semibold",children:"General Settings"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage your project name, key, icon and description."})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("h2",{className:"text-md font-medium",children:"Project Information"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Configure your project details and preferences."})]}),e.jsxs("div",{className:"space-y-4 border border-border rounded-md p-4 bg-sidebar",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx("p",{className:"text-sm font-medium",children:"Icon"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Displayed in the sidebar and project surfaces."})]}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs(X,{open:I,onOpenChange:N,modal:!0,children:[e.jsx(Y,{asChild:!0,children:e.jsx("button",{type:"button",className:"flex items-center justify-center p-2 rounded border border-border hover:border-zinc-400 dark:hover:border-zinc-600 transition-colors",title:"Pick icon",children:(()=>{const s=r.watch("icon")||"Layout",a=y[s]||y.Layout;return e.jsx(a,{className:"w-4 h-4 text-zinc-600 dark:text-zinc-400"})})()})}),e.jsx(Z,{className:"w-80 p-2",align:"end",children:e.jsx("div",{className:"max-h-[300px] overflow-y-auto",children:e.jsx("div",{className:"grid grid-cols-8 gap-2",children:Object.entries(y).map(([s,a])=>e.jsx("button",{type:"button",onClick:()=>{r.setValue("icon",s,{shouldDirty:!0,shouldValidate:!0});const z=r.getValues();m({...z,icon:s}),N(!1)},className:q("p-2 rounded-lg transition-all duration-200 flex items-center justify-center group hover:scale-105",r.getValues("icon")===s?"bg-indigo-50 text-indigo-600 dark:bg-indigo-500/10 dark:text-indigo-400":"text-zinc-600 dark:text-zinc-400 hover:bg-zinc-100 dark:hover:bg-zinc-700"),title:s,children:e.jsx(a,{className:"w-4 h-4"})},s))})})})]})})]}),e.jsx(g,{}),e.jsx(J,{...r,children:e.jsxs("form",{className:"space-y-4",children:[e.jsx(u,{control:r.control,name:"name",render:({field:s})=>e.jsxs(p,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(x,{className:"text-sm font-medium",children:"Project name"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"The name of your project"})]}),e.jsx(j,{children:e.jsx(f,{className:"w-64",placeholder:"Enter project name",...s})})]}),e.jsx(h,{})]})}),e.jsx(g,{}),e.jsx(u,{control:r.control,name:"slug",render:({field:s})=>e.jsxs(p,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(x,{className:"text-sm font-medium",children:"Key"}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Used for ticket IDs (e.g.,"," ",r.watch("slug")||"ABC","-123)"]})]}),e.jsx(j,{children:e.jsx(f,{className:"w-64",placeholder:"PRO",...s})})]}),e.jsx(h,{})]})}),e.jsx(g,{}),e.jsx(u,{control:r.control,name:"description",render:({field:s})=>e.jsxs(p,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(x,{className:"text-sm font-medium",children:"Description"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"A brief description of your project"})]}),e.jsx(j,{children:e.jsx(f,{className:"w-64",placeholder:"Enter project description",...s})})]}),e.jsx(h,{})]})})]})})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("h2",{className:"text-md font-medium",children:"Danger zone"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Irreversible and destructive actions."})]}),e.jsx("div",{className:"space-y-4 border border-border rounded-md p-4 bg-sidebar",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx("p",{className:"text-sm font-medium",children:"Delete project"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Schedule project to be permanently deleted"})]}),e.jsx($,{variant:"ghost",size:"sm",className:"text-destructive hover:text-destructive transition-colors",type:"button",onClick:()=>v(!0),disabled:!t,children:"Delete project"})]})})]}),e.jsx(R,{open:C,onOpenChange:v,children:e.jsxs(M,{children:[e.jsxs(B,{children:[e.jsx(G,{children:"Delete Project?"}),e.jsxs(U,{children:['This will permanently delete the project "',t?.name,'" and all its data. This action cannot be undone.']})]}),e.jsxs(H,{children:[e.jsx(W,{children:"Cancel"}),e.jsx(_,{onClick:T,disabled:k,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:k?"Deleting...":"Delete Project"})]})]})})]})]})}export{Be as component};
