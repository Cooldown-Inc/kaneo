import{r as f,a as w,j as e,f as b,t as i,e as v,g as F}from"./index-D6_JMR29.js";import{E as S,U as z,A as C,a as E}from"./toggle-BCaMxqsl.js";import{A as k}from"./layout-CvAhTMPV.js";import{s as A,o as P,a as j,e as I}from"./schemas-BanlPZIc.js";import{u as L}from"./index.esm-C6Qxl6lY.js";import{B as y}from"./button-EC3LtV52.js";import{F as U,a as d,b as u,c as x,d as p,e as h}from"./form-Bsr6zOGs.js";import{I as g}from"./input-BncAdNhM.js";import{L as T}from"./loader-circle-DwAUW7-I.js";import{E as B}from"./eye-RiKnMhFr.js";import{P as G}from"./page-title-D2qfPOLM.js";import"./createLucideIcon-CRcKb1Ol.js";import"./useQuery-BDxn_D7I.js";import"./index-Dtyx9z7_.js";import"./index-BrfIpMvE.js";import"./label-EHONJWOK.js";import"./index-MjJcs9DE.js";import"./index-Xyhz7DHc.js";const D=P({email:I(),password:j().min(8,{message:"Password is too short"}),name:j()});function R(){const[r,l]=f.useState(!1),[n,c]=f.useState(!1),m=w(),t=L({resolver:A(D),defaultValues:{email:"",password:"",name:""}}),o=async a=>{c(!0);try{const s=await b.signUp.email({email:a.email,name:a.name,password:a.password});if(s.error){i.error(s.error.message||"Failed to sign up"),c(!1);return}v.else.user.extension.initialize.$post().then(()=>{console.log("✅ Else extension initialized for new user")}).catch(N=>{console.error("Failed to initialize Else extension:",N)}),i.success("Account created successfully"),await m({to:"/dashboard/workspace/create",replace:!0})}catch(s){i.error(s instanceof Error?s.message:"Failed to sign up"),c(!1)}};return e.jsxs("div",{className:"relative",children:[n&&e.jsx("div",{className:"absolute inset-0 bg-white/80 dark:bg-zinc-900/80 backdrop-blur-sm rounded-lg z-50 flex items-center justify-center",children:e.jsxs("div",{className:"flex flex-col items-center gap-3",children:[e.jsx(T,{className:"h-8 w-8 animate-spin text-primary"}),e.jsx("p",{className:"text-sm text-muted-foreground font-medium",children:"Creating your account..."})]})}),e.jsx(U,{...t,children:e.jsxs("form",{onSubmit:t.handleSubmit(o),className:"space-y-3",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx(d,{control:t.control,name:"name",render:({field:a,fieldState:s})=>e.jsxs(u,{children:[e.jsx(x,{className:"text-sm font-medium",children:"Full Name"}),e.jsx(p,{children:e.jsx(g,{placeholder:"John Doe",type:"text",autoComplete:"name",...a})}),e.jsx(h,{children:s.error?.message})]})}),e.jsx(d,{control:t.control,name:"email",render:({field:a,fieldState:s})=>e.jsxs(u,{children:[e.jsx(x,{className:"text-sm font-medium",children:"Email"}),e.jsx(p,{children:e.jsx(g,{placeholder:"me@example.com",type:"email",autoComplete:"email",...a})}),e.jsx(h,{children:s.error?.message})]})}),e.jsx(d,{control:t.control,name:"password",render:({field:a,fieldState:s})=>e.jsxs(u,{children:[e.jsx(x,{className:"text-sm font-medium",children:"Password"}),e.jsx(p,{children:e.jsxs("div",{className:"relative",children:[e.jsx(g,{placeholder:"••••••••",type:r?"text":"password",autoComplete:"new-password",...a}),e.jsx("button",{type:"button",onClick:()=>l(!r),className:"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground","aria-label":r?"Hide password":"Show password","aria-pressed":r,children:r?e.jsx(S,{size:16}):e.jsx(B,{size:16})})]})}),e.jsx(h,{children:s.error?.message})]})})]}),e.jsx(y,{type:"submit",disabled:n,className:"w-full mt-4 text-white",children:n?"Creating Account...":"Create Account"})]})})]})}function te(){const r=w(),[l,n]=f.useState(!1),m=F.useSearch().debug==="1",t=async()=>{n(!0);try{const o=await b.signIn.anonymous();if(o.error)throw new Error(o.error.message);i.success("Signed in as guest"),r({to:"/dashboard"})}catch(o){i.error(o instanceof Error?o.message:"Failed to sign in as guest")}finally{n(!1)}};return e.jsxs(e.Fragment,{children:[e.jsx(G,{title:"Create Account"}),e.jsx(k,{banner:e.jsx(E,{}),children:e.jsxs("div",{className:"space-y-4",children:[m&&e.jsxs(e.Fragment,{children:[e.jsxs(y,{variant:"outline",onClick:t,disabled:l,className:"w-full mb-0",size:"sm",children:[e.jsx(z,{className:"w-4 h-4 mr-2"}),l?"Signing in...":"Continue as guest"]}),e.jsxs("div",{className:"flex items-center gap-4 my-4",children:[e.jsx("div",{className:"flex-1 h-px bg-zinc-200 dark:bg-zinc-800"}),e.jsx("span",{className:"text-sm text-zinc-500 dark:text-zinc-400",children:"or"}),e.jsx("div",{className:"flex-1 h-px bg-zinc-200 dark:bg-zinc-800"})]})]}),e.jsx(R,{}),e.jsx(C,{message:"Already have an account?",linkText:"Sign in",linkTo:"/auth/sign-in"})]})})]})}export{te as component};
