import{r as g,a as k,j as e,f as u,t as l,h as M,e as $,c as A,i as T,d as N}from"./index-D6_JMR29.js";import{P as v}from"./page-title-D2qfPOLM.js";import{B as x}from"./button-EC3LtV52.js";import{E as B,u as H,a as I,U as D,A as V}from"./toggle-BCaMxqsl.js";import{A as L}from"./layout-CvAhTMPV.js";import{s as F,o as C,e as G,a as O}from"./schemas-BanlPZIc.js";import{u as E}from"./index.esm-C6Qxl6lY.js";import{F as _,a as p,b as j,c as b,d as w,e as y}from"./form-Bsr6zOGs.js";import{I as S}from"./input-BncAdNhM.js";import{E as q}from"./eye-RiKnMhFr.js";import{S as h}from"./skeleton-DqNmaWOh.js";import{G as J}from"./github-DV800XGA.js";import"./index-Dtyx9z7_.js";import"./index-BrfIpMvE.js";import"./createLucideIcon-CRcKb1Ol.js";import"./useQuery-BDxn_D7I.js";import"./label-EHONJWOK.js";import"./index-MjJcs9DE.js";import"./index-Xyhz7DHc.js";const K=C({email:G()});function Q(){const[s,o]=g.useState(!1),i=k(),t=E({resolver:F(K),defaultValues:{email:""}}),n=async a=>{o(!0);try{const c=await u.signIn.magicLink({email:a.email,callbackURL:"https://demo.somethingelse.ai/profile-setup"});if(c.error){l.error(c.error.message||"Failed to send magic link");return}l.success("Magic link sent! Check your email to sign in."),i({to:"/auth/check-email",search:{email:a.email}})}catch(c){l.error(c instanceof Error?c.message:"Failed to send magic link")}finally{o(!1)}};return e.jsx(_,{...t,children:e.jsxs("form",{onSubmit:t.handleSubmit(n),className:"space-y-3",children:[e.jsx("div",{className:"space-y-3",children:e.jsx(p,{control:t.control,name:"email",render:({field:a,fieldState:c})=>e.jsxs(j,{children:[e.jsx(b,{className:"text-sm font-medium",children:"Email"}),e.jsx(w,{children:e.jsx(S,{placeholder:"me@example.com",type:"email",autoComplete:"email",...a})}),e.jsx(y,{children:c.error?.message})]})})}),e.jsx(x,{type:"submit",disabled:s,className:"w-full mt-4 text-white",children:s?"Sending...":"Send Magic Link"})]})})}const W=C({email:G(),password:O()});function X(){const[s,o]=g.useState(!1),[i,t]=g.useState(!1),{history:n}=M(),a=E({resolver:F(W),defaultValues:{email:"",password:""}}),c=async m=>{t(!0);try{const d=await u.signIn.email({email:m.email,password:m.password});if(d.error){l.error(d.error.message||"Failed to sign in");return}$.else.user.extension.initialize.$post().then(()=>{console.log("✅ Else extension initialized for user")}).catch(f=>{console.error("Failed to initialize Else extension:",f)}),l.success("Signed in successfully"),setTimeout(()=>{n.push("/dashboard")},500)}catch(d){l.error(d instanceof Error?d.message:"Failed to sign in")}finally{t(!1)}};return e.jsx(_,{...a,children:e.jsxs("form",{onSubmit:a.handleSubmit(c),className:"space-y-3",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx(p,{control:a.control,name:"email",render:({field:m})=>e.jsxs(j,{children:[e.jsx(b,{className:"text-sm font-medium",children:"Email"}),e.jsx(w,{children:e.jsx(S,{placeholder:"me@example.com",type:"email",autoComplete:"email",...m})}),e.jsx(y,{})]})}),e.jsx(p,{control:a.control,name:"password",render:({field:m})=>e.jsxs(j,{children:[e.jsx(b,{className:"text-sm font-medium",children:"Password"}),e.jsx(w,{children:e.jsxs("div",{className:"relative",children:[e.jsx(S,{placeholder:"••••••••",type:s?"text":"password",autoComplete:"current-password",...m}),e.jsx("button",{type:"button",onClick:()=>o(!s),className:"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground","aria-label":s?"Hide password":"Show password","aria-pressed":s,children:s?e.jsx(B,{size:16}):e.jsx(q,{size:16})})]})}),e.jsx(y,{})]})})]}),e.jsx(x,{type:"submit",disabled:i,size:"sm",className:"w-full mt-4 text-white",children:i?"Signing In...":"Sign In"})]})})}function Y(){const s=A.c(5);let o;s[0]===Symbol.for("react.memo_cache_sentinel")?(o=e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx(h,{className:"h-10 w-full"}),e.jsx(h,{className:"h-9 w-full"})]}),s[0]=o):o=s[0];let i;s[1]===Symbol.for("react.memo_cache_sentinel")?(i=e.jsxs("div",{className:"flex items-center gap-4 my-4",children:[e.jsx("div",{className:"flex-1 h-px bg-border"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"or"}),e.jsx("div",{className:"flex-1 h-px bg-border"})]}),s[1]=i):i=s[1];let t;s[2]===Symbol.for("react.memo_cache_sentinel")?(t=e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{className:"h-4 w-12"}),e.jsx(h,{className:"h-10 w-full"})]}),s[2]=t):t=s[2];let n;s[3]===Symbol.for("react.memo_cache_sentinel")?(n=e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"space-y-3",children:[t,e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{className:"h-4 w-16"}),e.jsx(h,{className:"h-10 w-full"})]})]}),e.jsx(h,{className:"h-9 w-full mt-4"})]}),s[3]=n):n=s[3];let a;return s[4]===Symbol.for("react.memo_cache_sentinel")?(a=e.jsxs("div",{className:"space-y-4 mt-6",children:[o,i,n,e.jsx("div",{className:"text-center",children:e.jsx(h,{className:"h-4 w-48 mx-auto"})})]}),s[4]=a):a=s[4],a}function be(){const s=k(),[o,i]=g.useState(!1),[t,n]=g.useState(!1),[a,c]=g.useState(!1),m=u.getLastUsedLoginMethod(),{data:d,isLoading:f}=H(),P=T.useSearch().debug==="1",R=async()=>{i(!0);try{const r=await u.signIn.anonymous();if(r.error)throw new Error(r.error.message);l.success("Signed in as guest"),s({to:"/dashboard"})}catch(r){l.error(r instanceof Error?r.message:"Failed to sign in as guest")}finally{i(!1)}},z=async()=>{c(!0);try{const r=await u.signIn.social({provider:"google",callbackURL:"https://demo.somethingelse.ai/dashboard",errorCallbackURL:"https://demo.somethingelse.ai/auth/sign-in"});if(r.error)throw new Error(r.error.message);l.success("Signed in with Google"),s({to:"/dashboard"})}catch(r){l.error(r instanceof Error?r.message:"Failed to sign in as guest")}finally{i(!1)}},U=async()=>{n(!0);try{const r=await u.signIn.social({provider:"github",callbackURL:"https://demo.somethingelse.ai/dashboard",errorCallbackURL:"https://demo.somethingelse.ai/auth/sign-in"});if(r.error)throw new Error(r.error.message);l.success("Signed in with Github"),s({to:"/dashboard"}),n(!1)}catch(r){l.error(r instanceof Error?r.message:"Failed to sign in with Github")}finally{n(!1)}};return f?e.jsxs(e.Fragment,{children:[e.jsx(v,{title:"Sign In"}),e.jsx(L,{banner:e.jsx(I,{}),children:e.jsx(Y,{})})]}):e.jsxs(e.Fragment,{children:[e.jsx(v,{title:"Sign In"}),e.jsx(L,{banner:e.jsx(I,{}),children:e.jsxs("div",{className:"space-y-4",children:[P&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{className:"relative",children:[d?.hasGoogleSignIn&&e.jsxs(x,{variant:"outline",onClick:z,disabled:a,className:N("w-full mb-2",m==="google"&&"!border-primary/50"),children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:[e.jsx("title",{children:"Google"}),e.jsx("path",{d:"M12.48 10.92v3.28h7.84c-.24 1.84-.853 3.187-1.787 4.133-1.147 1.147-2.933 2.4-6.053 2.4-4.827 0-8.6-3.893-8.6-8.72s3.773-8.72 8.6-8.72c2.6 0 4.507 1.027 5.907 2.347l2.307-2.307C18.747 1.44 16.133 0 12.48 0 5.867 0 .307 5.387.307 12s5.56 12 12.173 12c3.573 0 6.267-1.173 8.373-3.36 2.16-2.16 2.84-5.213 2.84-7.667 0-.76-.053-1.467-.173-2.053H12.48z",fill:"currentColor"})]}),a?"Signing in...":"Continue with Google",m==="google"&&e.jsx("span",{className:"absolute rounded-md -top-3 right-1 px-1.5 text-xs text-primary font-medium bg-sidebar border border-primary/50",children:"Last used"})]}),d?.hasGithubSignIn&&e.jsxs(x,{variant:"outline",onClick:U,disabled:t,className:N("w-full",m==="github"&&"!border-primary/50"),children:[e.jsx(J,{className:"w-4 h-4 mr-2"}),t?"Signing in...":"Continue with GitHub",m==="github"&&e.jsx("span",{className:"absolute rounded-md -top-3 right-1 px-1.5 text-xs text-primary font-medium bg-sidebar border border-primary/50",children:"Last used"})]})]}),e.jsxs(x,{variant:"outline",onClick:R,disabled:o,className:"w-full",size:"sm",children:[e.jsx(D,{className:"w-4 h-4 mr-2"}),o?"Signing in...":"Continue as guest"]})]}),e.jsxs("div",{className:"flex items-center gap-4 my-4",children:[e.jsx("div",{className:"flex-1 h-px bg-border"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"or"}),e.jsx("div",{className:"flex-1 h-px bg-border"})]})]}),d?.hasSmtp?e.jsx(Q,{}):e.jsx(X,{}),e.jsx(V,{message:"Don't have an account?",linkText:"Create account",linkTo:"/auth/sign-up"})]})})]})}export{be as component};
